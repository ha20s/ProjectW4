const stories = [
    {
        title: "الدولة السعودية الأولى",
        id : 1,
        img: "https://omarsug.com/wp-content/uploads/2019/09/jpeg.jpg",
        parts: [
            {
                text: "كانت منطقة الجزيرة العربية في أوائل القرن الثاني عشر الهجري (الثامن عشر ميلادي) تعيش في حالة من الفوضى وعدم الاستقرار السياسي، وصف المؤرخون الحالة السياسية والاجتماعية بالتفكك وانعدام الأمن وكثرة الإمارات المتناثرة والمتناحرة.",
                question: {
                    text: "كيف كانت الحالة السياسية والاجتماعية في منطقة الجزيرة العربية في أوائل القرن الثاني عشر الهجري؟",
                    options: [
                        "استقرار سياسي وأمني",
                        "تفكك وانعدام الأمن وكثرة الإمارات المتناحرة",
                        "نمو اقتصادي كبير"
                    ],
                    correct: 1
                }
            },
            {
                text: "وفي عام 1139هـ (1727م) تأسست الدولة السعودية الأولى على يد الإمام محمد بن سعود وعاصمتها الدرعية. وتمكن أئمة الدولة السعودية الأولى من توحيد معظم مناطق شبه الجزيرة العربية، مما نقلها إلى عهد جديد اتسم بالاستقرار والأمن.",
                question: {
                    text: "من هو مؤسس الدولة السعودية الأولى؟",
                    options: [
                        "الإمام عبد الله بن سعود",
                        "الإمام محمد بن سعود",
                        "الإمام عبد العزيز بن محمد"
                    ],
                    correct: 1
                }
            },
            {
                text: "كان انتهاء الدولة السعودية الأولى عام 1233هـ نتيجة للحملات التي أرسلتها الدولة العثمانية بقيادة والي مصر محمد علي، والتي culminated in the destruction of the capital, Diriyah.",
                question: {
                    text: "ما سبب انتهاء الدولة السعودية الأولى؟",
                    options: [
                        "نتيجة للحملات التي أرسلتها الدولة العثمانية",
                        "ضعف حكام الدولة",
                        "خلافات داخلية"
                    ],
                    correct: 0
                }
            }
        ]
    },

    {
        title: "الدولة السعودية الثانية",
        id : 2 ,
        img: "https://omarsug.com/wp-content/uploads/2019/09/d-ksapix4aamdnh.jpg",
        parts: [
            {
                text: "على الرغم من الدمار الذي خلفته قوات إبراهيم باشا، فإن ولاء سكان الجزيرة لأسرة آل سعود ظل قائمًا. وفي عام 1240هـ (1824م) استطاع الإمام تركي بن عبد الله بن محمد بن سعود إعادة تأسيس الدولة السعودية الثانية وعاصمتها الرياض.",
                question: {
                    text: "كيف تم تأسيس الدولة السعودية الثانية؟",
                    options: [
                        "من خلال الإمارة في الدرعية",
                        "بقيادة الإمام تركي بن عبد الله",
                        "بدعم الدولة العثمانية"
                    ],
                    correct: 1
                }
            },
            {
                text: "استمرت الدولة السعودية الثانية على الأسس نفسها التي قامت عليها الدولة السعودية الأولى، من حيث اعتمادها على الإسلام، ونشر الأمن، وتطبيق الشريعة الإسلامية.",
                question: {
                    text: "ما هي الأسس التي قامت عليها الدولة السعودية الثانية؟",
                    options: [
                        "التركيز على القوة العسكرية",
                        "اعتمادها على الإسلام والشريعة",
                        "التحالف مع القوى الغربية"
                    ],
                    correct: 1
                }
            },
            {
                text: "انتهت الدولة السعودية الثانية عام 1309هـ (1891م) عندما غادر الإمام عبد الرحمن بن فيصل بن تركي الرياض نتيجة للخلافات مع آل رشيد.",
                question: {
                    text: "ما سبب انتهاء الدولة السعودية الثانية؟",
                    options: [
                        "خلافات مع آل رشيد",
                        "ضعف حكام الدولة",
                        "ثورات داخلية"
                    ],
                    correct: 0
                }
            }
        ]
    },

    {
        title: "المملكة العربية السعودية",
        id : 3 ,
        img: "https://omarsug.com/wp-content/uploads/2019/09/d8add8acd8a7d8ac-d98ad8b3d8aad982d984d988d986-d8a7d984d8a8d8a7d8b5d8a7d8aa-d984d8b1d8add984d8aad987d985-d985d986-d8acd8afd8a9-d8a7d984d989-d985d983d8a9-1933-d985.jpg",
        parts: [
            {
                text: "في الخامس من شوال عام 1319هـ (1902م)، استطاع الملك عبد العزيز بن عبد الرحمن آل سعود استرداد الرياض والبدء بتأسيس المملكة العربية السعودية الحديثة.",
                question: {
                    text: "متى استرد الملك عبد العزيز الرياض؟",
                    options: [
                        "1902م",
                        "1913م",
                        "1921م"
                    ],
                    correct: 0
                }
            },
            {
                text: "في عام 1932م، أعلن الملك عبد العزيز توحيد البلاد تحت مسمى 'المملكة العربية السعودية'.",
                question: {
                    text: "ما هو التاريخ الذي تم فيه إعلان توحيد المملكة العربية السعودية؟",
                    options: [
                        "1930م",
                        "1932م",
                        "1935م"
                    ],
                    correct: 1
                }
            },
            {
                text: "أصبحت المملكة العربية السعودية ذات مكانة دولية خاصة، حيث انضمت إلى العديد من المنظمات الدولية، وكانت من أوائل الدول الموقعة على ميثاق هيئة الأمم المتحدة.",
                question: {
                    text: "ما هي بعض الإنجازات الدولية التي حققتها المملكة في عهد الملك عبد العزيز؟",
                    options: [
                        "الانضمام إلى الأمم المتحدة",
                        "توقيع اتفاقيات تجارية فقط",
                        "دعم الحروب الإقليمية"
                    ],
                    correct: 0
                }
            }
        ]
    }
];



let storyList = document.getElementById("storyList");

if (storyList) {
    stories.forEach(story => {

        let col = document.createElement('div');
        col.className = 'col-lg-4 col-md-6 col-sm-12 p-3 card-hover';

        let card = document.createElement('div');
        card.className = 'card text-center';
        card.style.backgroundImage = `url(${story.img})`;
        card.style.backgroundSize = 'cover';
        card.style.backgroundPosition = 'center';
        card.style.height = '40vh';
        card.style.width = 'auto';

        let cardBody = document.createElement('div');
        cardBody.className = 'card-body d-flex flex-column m-0 p-0';

        let title = document.createElement('div');
        title.classList.add('card-title', 'w-100', 'p-3', 'rounded', 'h4', 'link-offset-1');
        title.style.backgroundColor = 'rgba(251, 246, 244, 0.8)';
        title.textContent = story.title;

        card.onclick = () => {
            localStorage.setItem('currentStory', JSON.stringify(story));
            window.location.href = 'story.html'; 
        };

        cardBody.appendChild(title);
        card.appendChild(cardBody);
        col.appendChild(card);

        storyList.appendChild(col);
    });
} else {
    console.error("Element with id 'storyList' not found.");
}





// part of user 


let userUrl = "https://66e7e6a5b17821a9d9da6f39.mockapi.io/login";


let signUpForm = document.getElementById("signUpForm");
if (signUpForm) {
    signUpForm.addEventListener('submit', (event) => {
        event.preventDefault(); 

        let nameSign = document.getElementById("name").value;
        let usernameSign = document.getElementById("username").value;
        let emailSign = document.getElementById("emailSign").value;
        let passSign = document.getElementById("passSign").value;

        if (!ValidateName(nameSign) || !ValidateUserName(usernameSign) || 
            !ValidateEmail(emailSign) || !ValidatePass(passSign)) {
            return; 
        }


        fetch(userUrl, {
            method: 'POST',
            body: JSON.stringify({
                name: nameSign,
                userName: usernameSign,
                email: emailSign,
                pass: passSign
            }),
            headers: {
                'Content-type': 'application/json; charset=UTF-8',
            },
        })
        .then((response) => response.json()) 
        .then((json) => {
            console.log(json); 
            window.location.href = 'main.html'; 
        })
        .catch((error) => {
            console.error('There was a problem with the fetch operation:', error);
        });
    });
}


let loginForm = document.getElementById("loginForm");
if (loginForm) {
    loginForm.addEventListener('submit', (event) => {
        event.preventDefault(); 

        let emailLogin = document.getElementById("emailLogin").value;
        let passLogin = document.getElementById("loginPass").value;

        fetch(userUrl)
            .then((response) => response.json()) 
            .then((json) => {
                const user = json.find(item => item.email === emailLogin && item.pass === passLogin);

                if (user) {
                    window.location.href = 'main.html'; 
                } else {
                    alert("البريد الإلكتروني أو كلمة المرور غير صحيحة"); 
                }
            })
            .catch((error) => {
                console.error('There was a problem with the fetch operation:', error);
            });
    });
}


function ValidateEmail(email) {
    const emailRegex = /^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;
    if (!emailRegex.test(email)) {
        alert("يجب أن يكون لديك بريد إلكتروني صالح");
        return false;
    }
    return true;
}

function ValidatePass(pass) {
    if (pass.length < 8) {
        alert("يجب أن يكون الرقم السري أكثر من 8 أحرف");
        return false;
    }
    return true;
}

function ValidateName(name) {
    if (name.length < 5) {
        alert("يجب أن يكون الاسم أكثر من 5 أحرف");
        return false;
    }
    return true;
}

function ValidateUserName(username) {
    const check = /[A-Z]/;
    if (!check.test(username)) {
        alert("يجب أن يحتوي اسم المستخدم على حرف كبير");
        return false;
    }
    return true;
}


let submitLogin = document.getElementById("submitLogin");
let emailLogin = document.getElementById("emailLogin");
let passLogin = document.getElementById("loginPass");

if (submitLogin) {
    submitLogin.addEventListener('click', (event) => {
        event.preventDefault(); 

        fetch(userUrl)
            .then((response) => response.json())
            .then((json) => {
                const user = json.find(item => item.email === emailLogin.value && item.pass === passLogin.value);

                if (user) {
                    window.location.href = 'main.html';
                } else {
                    alert("البريد الإلكتروني أو كلمة المرور غير صحيحة");
                }
            })
            .catch((error) => {
                console.error('There was a problem with the fetch operation:', error);
            });
    });
}
